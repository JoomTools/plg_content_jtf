/**
 * @package      Joomla.Plugin
 * @subpackage   Content.Jtf
 *
 * @author       Guido De Gobbis <support@joomtools.de>
 * @copyright    (c) 2019 JoomTools.de - All rights reserved.
 * @license      GNU General Public License version 3 or later
 **/domIsReady(()=>{let a=(a,b)=>{function c(a){if(a){let b=new RegExp(a);if(b.test(j))return!0}return!1}function d(a){let b=0;for(let c=0,d=a[c];c<a.length;c++)b+=d.size;return b}function e(){p.classList.add("invalid"),p.setAttribute("aria-invalid",!0),l.classList.add("invalid"),l.setAttribute("aria-invalid",!0),n.classList.add("invalid"),n.setAttribute("aria-invalid",!0)}function f(){p.classList.remove("invalid"),p.setAttribute("aria-invalid",!1),l.classList.remove("invalid"),l.setAttribute("aria-invalid",!1),n.classList.remove("invalid"),n.setAttribute("aria-invalid",!1)}function g(a,b){var c=Math.abs;let d=b?1e3:1024;if(c(a)<d)return a+" B";let e=b?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],f=-1;do a/=d,++f;while(c(a)>=d&&f<e.length-1);return a.toFixed(1)+" "+e[f]}function h(a){let b={},h=[],j="";b="undefined"==typeof a.originalEvent?a.target.files:a.originalEvent.target.files;let k=d(b);for(let d=0,e=b[d];d<b.length;d++)c(e.type)?h.push("<li><strong>Upload: ",e.name,"</strong> (",g(e.size,!0),")</li>"):j+="<p><strong>Error: "+e.name+"</strong> - "+u+"</p>";k>r&&(j+="<p><strong>Error: "+g(k,!0)+"</strong> - "+t+"</p>"),j?(e(),document.formvalidator.setHandler("file",()=>!1)):(f(),document.formvalidator.setHandler("file",()=>!0)),o.innerHTML=j+"<ul style=\"text-align: left;\">"+h.join("")+"</ul>"}let j="",k="";const l=a.querySelector(".dragarea"),m=a.querySelector(".allowedExt"),n=document.querySelector("#"+b.id),o=a.querySelector(".upload-list"),p=document.querySelector("label[for=\""+b.id+"\""),q=n.getAttribute("accept").split(","),r=b.uploadMaxSize,s=Joomla.JText._("JTF_UPLOAD_ALLOWED_FILES_EXT",""),t=Joomla.JText._("JTF_UPLOAD_ERROR_MESSAGE_SIZE",""),u=Joomla.JText._("JTF_UPLOAD_ERROR_FILE_NOT_ALLOWED","");// Set list of mimetype and file extension
for(let c=0,d="";c<q.length;++c){let a=mimelite.getType(q[c].replace(".","")),b=mimelite.getExtension(q[c].replace(".",""));null===a&&(a=mimelite.getTypes(q[c].replace(".",""))),null===b&&(b=q[c].replace(".","")),null!==b&&(d=k?",":"",k+=d+b,"zip"===b&&(j+=d+"application/x-zip-compressed")),null!==a&&(d=j?",":"",j+=d+a)}k="."+k.replace(/,/g," ."),j=j.replace(/,/g," "),m.innerHTML=s+k,"undefined"!=typeof n&&(n.addEventListener("drag dragstart dragend dragover dragenter dragleave change",a=>{a.preventDefault(),a.stopPropagation()}),n.addEventListener("dragenter dragover",()=>{l.classList.add("hover")}),n.addEventListener("dragleave dragend drop",()=>{l.classList.remove("hover")}),n.addEventListener("change",a=>{h(a)}))};document.querySelectorAll(".uploader-wrapper").forEach(b=>{a(b,{id:b.querySelector(".legacy-uploader input[type=\"file\"]").getAttribute("id"),uploadMaxSize:b.querySelector(".legacy-uploader input[type=\"hidden\"]").getAttribute("value")})})});
