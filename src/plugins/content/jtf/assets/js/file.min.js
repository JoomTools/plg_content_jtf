"use strict";var jtfUploadFile=function(e,t){for(var r="",i="",a=e.querySelector(".dragarea"),n=e.querySelector(".allowedExt"),l=document.querySelector("#"+t.id),o=e.querySelector(".upload-list"),d=document.querySelector('label[for="'+t.id+'"'),s=l.getAttribute("accept").split(","),u=t.uploadMaxSize,c=Joomla.JText._("JTF_UPLOAD_ALLOWED_FILES_EXT",""),p=Joomla.JText._("JTF_UPLOAD_ERROR_MESSAGE_SIZE",""),v=Joomla.JText._("JTF_UPLOAD_ERROR_FILE_NOT_ALLOWED",""),g=0,f="";g<s.length;++g){var m=mimelite.getType(s[g].replace(".","")),E=mimelite.getExtension(s[g].replace(".",""));null===m&&(m=mimelite.getTypes(s[g].replace(".",""))),null===E&&(E=s[g].replace(".","")),null!==E&&(i+=(f=i?",":"")+E,"zip"===E&&(r+=f+"application/x-zip-compressed")),null!==m&&(r+=(f=r?",":"")+m)}function L(e){if(e&&new RegExp(e).test(r))return!0;return!1}function y(e,t){var r=t?1e3:1024;if(Math.abs(e)<r)return e+" B";var i=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],a=-1;do{e/=r,++a}while(Math.abs(e)>=r&&a<i.length-1);return e.toFixed(1)+" "+i[a]}function A(e){for(var t={},r=[],i="",n=function(e){for(var t=0,r=0,i=e[r];r<e.length;r++)t+=i.size;return t}(t=void 0!==e.originalEvent?e.originalEvent.target.files:e.target.files),s=0,c=t[s];s<t.length;s++)L(c.type)?r.push("<li><strong>Upload: ",c.name,"</strong> (",y(c.size,!0),")</li>"):i+="<p><strong>Error: "+c.name+"</strong> - "+v+"</p>";n>u&&(i+="<p><strong>Error: "+y(n,!0)+"</strong> - "+p+"</p>"),i?(d.classList.add("invalid"),d.setAttribute("aria-invalid",!0),a.classList.add("invalid"),a.setAttribute("aria-invalid",!0),l.classList.add("invalid"),l.setAttribute("aria-invalid",!0),document.formvalidator.setHandler("file",function(){return!1})):(d.classList.remove("invalid"),d.setAttribute("aria-invalid",!1),a.classList.remove("invalid"),a.setAttribute("aria-invalid",!1),l.classList.remove("invalid"),l.setAttribute("aria-invalid",!1),document.formvalidator.setHandler("file",function(){return!0})),o.innerHTML=i+'<ul style="text-align: left;">'+r.join("")+"</ul>"}i="."+i.replace(/,/g," ."),r=r.replace(/,/g," "),n.innerHTML=c+i,void 0!==l&&(l.addEventListener("drag dragstart dragend dragover dragenter dragleave change",function(e){e.preventDefault(),e.stopPropagation()}),l.addEventListener("dragenter dragover",function(e){a.classList.add("hover")}),l.addEventListener("dragleave dragend drop",function(e){a.classList.remove("hover")}),l.addEventListener("change",function(e){A(e)}))};domIsReady(function(){var e=document.querySelectorAll(".uploader-wrapper");Array.prototype.forEach.call(e,function(e){jtfUploadFile(e,{id:e.querySelector('.legacy-uploader input[type="file"]').getAttribute("id"),uploadMaxSize:e.querySelector('.legacy-uploader input[type="hidden"]').getAttribute("value")})})});