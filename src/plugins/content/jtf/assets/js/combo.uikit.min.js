/**
 * @package      Joomla.Plugin
 * @subpackage   Content.Jtf
 *
 * @author       Guido De Gobbis <support@joomtools.de>
 * @copyright    (c) 2017 JoomTools.de - All rights reserved.
 * @license      GNU General Public License version 3 or later
 **/
!function(o,n,t){o.fn.ComboTransform=function(t){return this.each(function(){!function(t,e){var i={},d=function(){var o=i.$elem.width(),n=o-3;i.$dropBtnDiv.width(),i.$dropDown.width()<n&&i.$dropDown.width(n+"px"),i.$dropDown.css("left","0px"),i.$dropDown.css("max-height","150px"),i.$dropDown.css("overflow-y","scroll"),i.$dropDown.css("left","0px"),i.$dropBtnDiv.attr("aria-haspopup","true"),i.$dropBtnDiv.attr("aria-expanded","false")},p=function(){i.$input.bind("focus",s),i.$input.bind("blur",u),i.options.updateList&&i.$input.bind("keyup",$),i.$dropDown.on("mouseenter",function(){c("clear"),i.$input.unbind("blur",u)}),i.$dropDown.on("mouseleave",function(o){i.$input.bind("blur",u)}),i.$dropBtn.on("click",l),i.$dropDown.find("li").on("click",a),i.$dropDown.find("li a").on("mouseenter",function(){o(this).addClass("hover"),i.$currHovered=o(this)}),i.$dropDown.find("li a").on("mouseleave",function(){o(this).removeClass("hover")})},s=function(){if(!i.$dropDown.isEmpty){var o=i.$dropDown.height(),n=(i.$input[0].clientHeight,-(i.$input.height()+o));i.$dropDown.css("top","100%"),i.$elem.addClass("nav-hover"),i.$dropBtnDiv.addClass("uk-open"),i.$dropBtnDiv.attr("aria-expanded","true"),v(i.$dropDown)||i.$dropDown.css("top",n+"px"),i.$input.bind("keypress keydown keyup",h)}},u=function(){i.$elem.removeClass("nav-hover"),i.$dropBtnDiv.removeClass("uk-open"),i.$dropBtnDiv.attr("aria-expanded","false"),i.$dropBtn.isClicked&&(i.$dropBtn.isClicked=!1,i.$dropDown.isEmpty=!0),c("clear"),i.$input.unbind("keypress keydown keyup",h)},l=function(){i.$dropDownOptions.show(),i.$dropBtn.isClicked=i.$dropDown.isEmpty,i.$dropDown.isEmpty=!1,i.$input.focus()},a=function(n){var t=o(n.target).text();return i.$input.val(t),u(),!1},$=function(n){var t=n&&(n.keycode||n.which);if((t=n.ctrlKey||n.altKey?-1:t)>47&&t<59||t>62&&t<127||32==t||8==t){var e=i.$input.val().toLowerCase(),r=i.$dropDownOptions,d=0,p=!1;r.each(function(){0==this.innerHTML.toLowerCase().indexOf(e)?o(this).show():(o(this).hide(),o(this).hasClass("hover")&&(p=!0),d++)}),d==r.length?(i.$dropDown.isEmpty=!0,u()):(i.$dropDown.isEmpty=!1,p&&c("clear"),s())}else i.$dropDown.isEmpty||(38==t?c("prev"):40==t?c("next"):13==t&&null!=i.$currHovered&&(i.$input.val(i.$currHovered.html()),u()))},c=function(o){if("next"==o||"prev"==o){var n,t=i.$dropDownOptions.filter(":visible"),e=t.filter(".hover"),r=t.index(e);r="prev"==o?-1==r?t.length-1:r-1:r==t.length-1?0:r+1,0!=e.length&&e.removeClass("hover"),n=t.eq(r),i.$currHovered=n,i.$currHovered.addClass("hover"),f(i.$dropDown,i.$currHovered)}else"clear"==o&&(null!=i.$currHovered&&i.$currHovered.removeClass("hover"),i.$currHovered=null)},v=function(o){var t=o[0].getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||n.documentElement.clientHeight)&&t.right<=(window.innerWidth||n.documentElement.clientWidth)},f=function(o,n){if(z=o[0].getBoundingClientRect(),r=n[0].getBoundingClientRect(),!(r.top>=z.top&&r.left>=z.left&&r.top+r.height<=z.top+z.height)){var t=r.top-z.top+o.scrollTop();o.scrollTop(t)}},h=function(o){13==o.keyCode&&o.preventDefault()};!function(n,t){i.$elem=o(t),i.options=o.extend({},o.fn.ComboTransform.options,n),i.$input=o(t).find('input[type="text"]'),i.$dropBtn=o(t).find('[type="button"]'),i.$dropBtnDiv=o(t).find("div.uk-button-group"),i.$dropDown=i.$dropBtnDiv.find("ul.uk-nav-dropdown"),i.$dropDownOptions=i.$dropDown.find("li a"),i.$dropDown.isEmpty=!1,i.$dropBtn.isClicked=!1,d(),p()}(t,e)}(t,this)})},o.fn.ComboTransform.options={updateList:!0},o(function(){o("div.combobox").ComboTransform({updateList:!0})})}(jQuery,document);