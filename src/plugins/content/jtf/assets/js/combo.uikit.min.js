!function($,document,undefined){$.fn.ComboTransform=function(options){return this.each(function(){!function(options,elem){var self={},render=function(){var inputWidth=self.$input.width(),totalWidth=inputWidth-3,dropDownLeft=-inputWidth+self.$dropBtn.width()-10;self.$dropDown.width()<totalWidth&&self.$dropDown.width(totalWidth+"px"),self.$dropDown.css("left",dropDownLeft+"px"),self.$dropDown.css("max-height","150px"),self.$dropDown.css("overflow-y","scroll"),self.$dropDown.css("left",dropDownLeft+"px"),self.$dropBtnDiv.attr("aria-haspopup","true"),self.$dropBtnDiv.attr("aria-expanded","false")},addEventHandlers=function(){self.$input.bind("focus",drop),self.$input.bind("blur",pick),self.options.updateList&&self.$input.bind("keyup",updateList),self.$dropDown.on("mouseenter",function(){highlight("clear"),self.$input.unbind("blur",pick)}),self.$dropDown.on("mouseleave",function(event){self.$input.bind("blur",pick)}),self.$dropBtn.on("click",focusCombo),self.$dropDown.find("li").on("click",updateCombo),self.$dropDown.find("li a").on("mouseenter",function(){$(this).addClass("hover"),self.$currHovered=$(this)}),self.$dropDown.find("li a").on("mouseleave",function(){$(this).removeClass("hover")})},drop=function(){if(!self.$dropDown.isEmpty){var dropDownHeight=self.$dropDown.height(),dropDownTop=(self.$input[0].clientHeight,-(self.$input.height()+dropDownHeight));self.$dropDown.css("top","100%"),self.$elem.addClass("nav-hover"),self.$dropBtnDiv.addClass("uk-open"),self.$dropBtnDiv.attr("aria-expanded","true"),inViewport(self.$dropDown)||self.$dropDown.css("top",dropDownTop+"px"),self.$input.bind("keypress keydown keyup",preventSubmit)}},pick=function(){self.$elem.removeClass("nav-hover"),self.$dropBtnDiv.removeClass("uk-open"),self.$dropBtnDiv.attr("aria-expanded","false"),self.$dropBtn.isClicked&&(self.$dropBtn.isClicked=!1,self.$dropDown.isEmpty=!0),highlight("clear"),self.$input.unbind("keypress keydown keyup",preventSubmit)},focusCombo=function(){self.$dropDownOptions.show(),self.$dropBtn.isClicked=self.$dropDown.isEmpty,self.$dropDown.isEmpty=!1,self.$input.focus()},updateCombo=function(event){var selectedOption=$(event.target).text();return self.$input.val(selectedOption),pick(),!1},updateList=function(event){var keycode=event&&(event.keycode||event.which);if(47<(keycode=event.ctrlKey||event.altKey?-1:keycode)&&keycode<59||62<keycode&&keycode<127||32==keycode||8==keycode){var text=self.$input.val().toLowerCase(),$options=self.$dropDownOptions,hiddenOptions=0,moveHilighter=!1;$options.each(function(){0==this.innerHTML.toLowerCase().indexOf(text)?$(this).show():($(this).hide(),$(this).hasClass("hover")&&(moveHilighter=!0),hiddenOptions++)}),hiddenOptions==$options.length?(self.$dropDown.isEmpty=!0,pick()):(self.$dropDown.isEmpty=!1,moveHilighter&&highlight("clear"),drop())}else self.$dropDown.isEmpty||(38==keycode?highlight("prev"):40==keycode?highlight("next"):13==keycode&&null!=self.$currHovered&&(self.$input.val(self.$currHovered.html()),pick()))},highlight=function(newHighlight){if("next"==newHighlight||"prev"==newHighlight){var $optionToHover,$visibleOptions=self.$dropDownOptions.filter(":visible"),$currHovered=$visibleOptions.filter(".hover"),index=$visibleOptions.index($currHovered);index="prev"==newHighlight?-1==index?$visibleOptions.length-1:index-1:index==$visibleOptions.length-1?0:index+1,0!=$currHovered.length&&$currHovered.removeClass("hover"),$optionToHover=$visibleOptions.eq(index),self.$currHovered=$optionToHover,self.$currHovered.addClass("hover"),scrollTo(self.$dropDown,self.$currHovered)}else"clear"==newHighlight&&(null!=self.$currHovered&&self.$currHovered.removeClass("hover"),self.$currHovered=null)},inViewport=function(el){var rect=el[0].getBoundingClientRect();return 0<=rect.top&&0<=rect.left&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},scrollTo=function(p,e){if(z=p[0].getBoundingClientRect(),r=e[0].getBoundingClientRect(),!(r.top>=z.top&&r.left>=z.left&&r.top+r.height<=z.top+z.height)){var value=r.top-z.top+p.scrollTop();p.scrollTop(value)}},preventSubmit=function(event){13==event.keyCode&&event.preventDefault()};!function(options,elem){self.$elem=$(elem),self.options=$.extend({},$.fn.ComboTransform.options,options),self.$input=$(elem).find('input[type="text"]'),self.$dropBtn=$(elem).find('[type="button"]'),self.$dropBtnDiv=$(elem).find("div.uk-button-group"),self.$dropDown=self.$dropBtnDiv.find("ul.uk-nav-dropdown").parent(),self.$dropDownOptions=self.$dropDown.find("li a"),self.$dropDown.isEmpty=!1,self.$dropBtn.isClicked=!1,render(),addEventHandlers()}(options,elem)}(options,this)})},$.fn.ComboTransform.options={updateList:!0},$(function(){$("div.combobox").ComboTransform({updateList:!0})})}(jQuery,document);